(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{10:function(e,t,n){},14:function(e,t,n){e.exports=n(21)},19:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a,i,r=n(0),l=n.n(r),s=n(11),o=n.n(s),u=(n(19),n(20),n(2)),c=n(5),m=n(7),d=n(6);n(10);!function(e){e.Playing="playing",e.Won="won",e.Lost="lost",e.Idle="idle"}(a||(a={})),function(e){e.Easy="easy",e.Medium="medium",e.Hard="hard"}(i||(i={}));var f=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(u.a)(this,e),this.numberOfColumns=t,this.numberOfRows=n,this.numberOfMines=a,this._fields=void 0,this._minePositions=void 0,this._numberOfFlags=0,this._numberOfRevealedFields=0,this._fields=[],this._minePositions=[],this.initializeBlankFields(),this.rollMinePositions(),this.distributeMines(),this.calculateNumberOfMineNeighbors()}return Object(c.a)(e,[{key:"toggleFlagForField",value:function(e){var t=this.getFieldByPosition(e.position);t&&(t.isFlagged=!t.isFlagged,this._numberOfFlags=t.isFlagged?this.numberOfFlags+1:this.numberOfFlags-1)}},{key:"revealField",value:function(e){var t=this.getFieldByPosition(e.position);t&&(t.isRevealed=!0),this._numberOfRevealedFields++}},{key:"revealAllFields",value:function(){var e=this;this._fields.forEach((function(t){e.revealField(t)}))}},{key:"getFieldByPosition",value:function(e){if(!(e.x>=this.numberOfColumns||e.x<0||e.y>=this.numberOfRows||e.y<0))return this._fields.find((function(t){return t.position.x===e.x&&t.position.y===e.y}));console.warn("Tried to get field by invalid position.",e)}},{key:"getNeighborsOfField",value:function(e){var t=e.position.x,n=e.position.y,a=n-1>=0,i=t-1>=0,r=t+1<this.numberOfColumns,l=n-1<this.numberOfRows;return this._fields.filter((function(e){var s=e.position.x,o=e.position.y,u=!1,c=!1,m=!1,d=!1,f=!1,h=!1,v=!1,g=!1;return a&&i&&(u=s===t-1&&o===n-1),a&&(c=s===t&&o===n-1),a&&r&&(m=s===t+1&&o===n-1),i&&(d=s===t-1&&o===n),r&&(f=s===t+1&&o===n),l&&i&&(h=s===t-1&&o===n+1),l&&(v=s===t&&o===n+1),l&&r&&(g=s===t+1&&o===n+1),u||c||m||d||f||h||v||g}))}},{key:"initializeBlankFields",value:function(){for(var e=0;e<this.numberOfFields;e++)this._fields.push({hasMine:!1,isRevealed:!1,isFlagged:!1,position:{x:e%this.numberOfColumns,y:Math.floor(e/this.numberOfColumns)},numberOfMineNeighbors:0})}},{key:"rollMinePositions",value:function(){for(var e=this,t=function(){var t=Math.floor(Math.random()*e.numberOfColumns),n=Math.floor(Math.random()*e.numberOfRows),a={x:t,y:n};e._minePositions.some((function(e){return e.x===t&&e.y===n}))||e._minePositions.push(a)};this._minePositions.length<this.numberOfMines;)t()}},{key:"distributeMines",value:function(){var e=this;this._minePositions.forEach((function(t){var n=e.getFieldByPosition(t);void 0!==n?n.hasMine=!0:console.warn("Tried to set a mine on a undefined field!")}))}},{key:"calculateNumberOfMineNeighbors",value:function(){var e=this;this._fields.forEach((function(t){t.numberOfMineNeighbors=e.getNumberOfMineNeighborsForField(t)}))}},{key:"getNumberOfMineNeighborsForField",value:function(e){return this.getNeighborsOfField(e).filter((function(e){return e.hasMine})).length}},{key:"numberOfFields",get:function(){return this.numberOfRows*this.numberOfColumns}},{key:"numberOfFieldsToReveal",get:function(){return this.numberOfFields-this.numberOfMines-this._numberOfRevealedFields}},{key:"numberOfFlags",get:function(){return this._numberOfFlags}},{key:"numberOfMinesLeft",get:function(){return this.numberOfMines-this._numberOfFlags}},{key:"allFields",get:function(){return this._fields}},{key:"allMinePositions",get:function(){return this._minePositions}}]),e}(),h=function(e){return r.createElement("div",{className:"revealed neighbor-count-".concat(e.neighborCount)},r.createElement("span",null,e.neighborCount))},v=function(){return r.createElement("div",{className:"untouched"})},g=function(){return r.createElement("div",{className:"revealed has-mine"},r.createElement("span",{role:"img","aria-label":"mine"},"\ud83d\udca3"))},b=function(){return r.createElement("div",{className:"flagged"},r.createElement("span",{role:"img","aria-label":"flag"},"\ud83d\udea9"))},p=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))).handleReveal=function(){var t=e.props,n=t.field,a=t.onReveal;n.isRevealed||n.isFlagged||a(n)},e.handleMultiReveal=function(){var t=e.props,n=t.field,a=t.onMultiReveal;n.isRevealed&&a(n)},e.handleFlag=function(t){t.preventDefault();var n=e.props,a=n.field,i=n.onFlag;a.isRevealed||i(a)},e.revealedField=function(){return e.props.field.hasMine?r.createElement(g,null):r.createElement(h,{neighborCount:e.props.field.numberOfMineNeighbors})},e.unrevealedField=function(){return e.props.field.isFlagged?r.createElement(b,null):r.createElement(v,null)},e.field=function(){return e.props.field.isRevealed?e.revealedField():e.unrevealedField()},e.render=function(){return r.createElement("div",{className:"field",onClick:e.handleReveal,onContextMenu:e.handleFlag,onDoubleClick:e.handleMultiReveal},e.field())},e}return n}(r.Component),y=n(22),F=n(23),O=n(12),E=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).radioOptions=[{name:"Easy",value:i.Easy},{name:"Medium",value:i.Medium},{name:"Hard",value:i.Hard}],a.handleChangeSelection=function(e){a.setState({currentlySelectedLevel:e.target.value})},a.state={currentlySelectedLevel:i.Easy},a}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return r.createElement("div",{className:"level-chooser"},r.createElement(y.a,{toggle:!0},this.radioOptions.map((function(t,n){return r.createElement(F.a,{key:n,type:"radio",variant:"secondary",name:"radio",value:t.value,checked:t.value===e.state.currentlySelectedLevel,onFocus:e.handleChangeSelection},t.name)}))),r.createElement(O.a,{variant:"primary",onClick:function(){return e.props.onStartNewGameClick(e.state.currentlySelectedLevel)}},"Start new game!"))}}]),n}(r.Component),w=n(24),M=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).smiley=function(){switch(e.props.minesweeperState.gameStatus){case a.Playing:return"\ud83e\udd14";case a.Won:return"\ud83d\ude0e";case a.Lost:return"\ud83d\ude35";case a.Idle:return"\ud83d\ude34"}},e.elapsedTime=function(){var t,n,i=e.props.minesweeperState,r=null!==(t=i.startedAtTime)&&void 0!==t?t:0,l=null!==(n=i.stoppedAtTime)&&void 0!==n?n:r,s=function(e,t){return Math.floor((t-e)/1e3)};switch(i.gameStatus){case a.Playing:return"".concat(s(r,Date.now()));case a.Won:case a.Lost:return"".concat(s(r,l));case a.Idle:default:return"0"}},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.minesweeperState,t=e.board,n=e.gameStatus;return r.createElement(r.Fragment,null,r.createElement("div",{className:"smiley"},r.createElement("span",{role:"img","aria-label":"smiley"},this.smiley())),r.createElement("div",{className:"stats-display"},r.createElement(w.a,{className:"stat mr-3",variant:"danger"},r.createElement("span",{role:"img","aria-label":"mine"},"\ud83d\udca3"),"\xa0",r.createElement("span",null,n===a.Won?0:t.numberOfMinesLeft)),r.createElement(w.a,{className:"stat mr-3",variant:"secondary"},r.createElement("span",{role:"img","aria-label":"finger"},"\ud83d\udc46"),"\xa0",r.createElement("span",null,n===a.Playing?t.numberOfFieldsToReveal:0)),r.createElement(w.a,{className:"stat mr-3",variant:"secondary"},r.createElement("span",{role:"img","aria-label":"flag"},"\ud83d\udea9"),"\xa0",r.createElement("span",null,t.numberOfFlags)),r.createElement(w.a,{className:"stat",variant:"secondary"},r.createElement("span",{role:"img","aria-label":"time"},"\u23f2"),"\xa0",r.createElement("span",null,this.elapsedTime()))))}}]),n}(r.Component),k=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(e){var l;return Object(u.a)(this,n),(l=t.call(this,e)).refreshTimeout=void 0,l.startNewGame=function(e){switch(e){case i.Easy:l.setState({board:new f(9,9,10)});break;case i.Medium:l.setState({board:new f(16,16,40)});break;case i.Hard:l.setState({board:new f(30,16,100)})}l.setState({level:e,gameStatus:a.Playing,startedAtTime:Date.now()}),l.refreshTimeout=setInterval((function(){l.rerenderBoard()}),1e3)},l.handleReveal=function(e){var t=l.state.board;e.hasMine?l.loseGame(t):l.revealFieldsRecursively(e),0===t.numberOfFieldsToReveal&&l.winGame(t),l.rerenderBoard()},l.handleMultiReveal=function(e){var t=l.state.board.getNeighborsOfField(e),n=t.filter((function(e){return e.isFlagged})).length;e.numberOfMineNeighbors===n&&(t.filter((function(e){return!e.isFlagged&&!e.isRevealed})).forEach((function(e){return l.handleReveal(e)})),l.rerenderBoard())},l.revealFieldsRecursively=function(e){if(!e.isRevealed){var t=l.state.board;if(t.revealField(e),0===e.numberOfMineNeighbors)t.getNeighborsOfField(e).forEach((function(e){l.revealFieldsRecursively(e)}))}},l.handleFlag=function(e){l.state.board.toggleFlagForField(e),l.rerenderBoard()},l.board=function(){var e="board level-".concat(l.state.level," game-status-").concat(l.state.gameStatus);return r.createElement("div",{className:e},l.state.board.allFields.map((function(e,t){return r.createElement(p,{key:t,field:e,onReveal:function(e){return l.handleReveal(e)},onMultiReveal:function(e){return l.handleMultiReveal(e)},onFlag:function(e){return l.handleFlag(e)}})})))},l.howToUse=function(){return r.createElement("div",{className:"how-to-use"},"Left-click on a field to reveal it. ",r.createElement("br",null),"Right-click to set a flag.",r.createElement("br",null),"Double-click on a revealed field to multi-reveal all neighbors (if flags are set).")},l.render=function(){return r.createElement("section",{className:"minesweeper"},r.createElement(E,{onStartNewGameClick:l.startNewGame}),r.createElement(M,{minesweeperState:l.state}),l.board(),l.howToUse())},l.loseGame=function(e){e.revealAllFields(),clearInterval(l.refreshTimeout),l.setState({gameStatus:a.Lost,stoppedAtTime:Date.now()})},l.rerenderBoard=function(){return l.setState({})},l.state={level:i.Easy,board:new f(0,0,0),gameStatus:a.Idle},l}return Object(c.a)(n,[{key:"winGame",value:function(e){e.revealAllFields(),clearInterval(this.refreshTimeout),this.setState({gameStatus:a.Won,stoppedAtTime:Date.now()})}}]),n}(r.Component);var N=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"App"},l.a.createElement("header",null,l.a.createElement("section",{className:"left"},l.a.createElement("a",{href:"https://github.com/PeterGuntermann/minesweeper",target:"blank"},"Source code on GitHub")),l.a.createElement("section",{className:"center"},l.a.createElement("h1",null,"Minesweeper")),l.a.createElement("section",{className:"right"},l.a.createElement("a",{href:"https://reactjs.org/",target:"blank"},"Made with React.JS"))),l.a.createElement(k,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.5b72b9e4.chunk.js.map